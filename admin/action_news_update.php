<?php    include("../_includes/session_test.inc");    include("../_includes/_revolutionfc.inc");    include("../_includes/_fileUpload.inc");    require_once '../vendor/ezyang/htmlpurifier/library/HTMLPurifier.auto.php'; // Include HTML Purifier            unset($_GET);        $zt_titre = isset($_POST['zt_titre']) ? nl2br(stripslashes($_POST['zt_titre'])) : retour_erreur(11, 121);    $zt_intro = isset($_POST['zt_intro']) ? nl2br(stripslashes($_POST['zt_intro'])) : retour_erreur(11, 122);    $userHtml = isset($_POST['ta_news']) ? $_POST['ta_news'] : retour_erreur(11, 123);    $section = isset($_POST['ld_section']) ? $_POST['ld_section'] : retour_erreur(11, 124);    $element = $_POST['element'];        // Create an HTML Purifier configuration    $config = HTMLPurifier_Config::createDefault();    $purifier = new HTMLPurifier($config);        // Clean and sanitize the HTML content    $cleanHtml = $purifier->purify($userHtml);        // Validate the length of the HTML content (adjust as needed)    $maxLength = 10000;    if (strlen($cleanHtml) > $maxLength) {        retour_erreur(11, 123); // Handle the error    }        // Define the valid file extensions    $extensions_valides = array('jpg', 'jpeg', 'png');    $page = '11';    $error_code = '1024';        if ($_FILES['f_photo_actu']['size'] == 0) {                $stmt = $db->prepare('UPDATE ACTUALITE SET titre = ?, intro = ?, texte = ?, id_section = ? WHERE id_actu = ?');        $execute = $stmt->execute([            addslashes($zt_titre),            addslashes($zt_intro),            $cleanHtml,            $section,            $element        ]);                if ($execute) {            $stmt->closeCursor();            retour_erreur(11, 3);        } else {            retour_erreur(11, 4);        }            } else {        // Handle file upload        $dossier = "img/_news/";        $destination = handleFileUpload($_FILES['f_photo_actu'], $dossier, $extensions_valides, $page, $error_code);                $stmt = $db->prepare('UPDATE ACTUALITE SET titre = ?, intro = ?, texte = ?, photo = ?, id_section = ? WHERE id_actu = ?');        $execute = $stmt->execute([            addslashes($zt_titre),            addslashes($zt_intro),            $cleanHtml,            $destination,            $section,            $element        ]);                if ($execute) {            $stmt->closeCursor();            retour_erreur(11, 3);        } else {            retour_erreur(11, 4);        }            }?>