<?php	include("../_includes/session_test.inc");	include("../_includes/_revolutionfc.inc");    include("../_includes/_fileUpload.inc");    require_once '../vendor/ezyang/htmlpurifier/library/HTMLPurifier.auto.php'; // Include HTML Purifier            unset($_GET);        $winter = isset($_POST['switch_winter']) && $_POST['switch_winter'] === 'on' ? 1 : 0;    $summer = isset($_POST['switch_summer']) && $_POST['switch_summer'] === 'on' ? 1 : 0;        $zt_title = isset($_POST['zt_title']) ? nl2br(stripslashes($_POST['zt_title'])) : retour_erreur(51, 121);    $zt_intro = isset($_POST['zt_intro']) ? nl2br(stripslashes($_POST['zt_intro'])) : retour_erreur(51, 122);    $registration = isset($_POST['zt_url']) ? $_POST['zt_url'] : retour_erreur(51, 7);    $userHtml = isset($_POST['ta_prog']) ? $_POST['ta_prog'] : retour_erreur(51, 123);        // Create an HTML Purifier configuration    $config = HTMLPurifier_Config::createDefault();    $purifier = new HTMLPurifier($config);    // Clean and sanitize the HTML content    $cleanHtml = $purifier->purify($userHtml);    // Validate the length of the HTML content (adjust as needed)    $maxLength = 10000;    if (strlen($cleanHtml) > $maxLength) {        retour_erreur(51, 123); // Handle the error    }        // Define the valid file extensions    $extensions_valides = array('jpg', 'jpeg', 'png');    $page = '51';    $error_code = '1024';        // Handle file upload    $dossier = "img/_programs/";    $destination = handleFileUpload($_FILES['f_photo_p'], $dossier, $extensions_valides, $page, $error_code);    $stmt = $db->prepare('INSERT into PROGRAMS (program_name, program_intro, url_registration, program_text, program_img, p_winter, p_summer VALUES (?, ?, ?, ?, ?, ?, ?)');    $execute = $stmt->execute([        $zt_title,        $zt_intro,        $registration,        $cleanHtml,        $destination,        $winter,        $summer    ]);    if ($execute) {        $stmt->closeCursor();        retour_erreur(51,501);    }    else {        retour_erreur(51,502);    }?>