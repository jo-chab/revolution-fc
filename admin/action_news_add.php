<?php	include("../_includes/session_test.inc");	include("../_includes/_revolutionfc.inc");	include("../_includes/_fileUpload.inc");    require_once '../vendor/ezyang/htmlpurifier/library/HTMLPurifier.auto.php'; // Include HTML Purifier		unset($_GET);        // Check if the required POST parameters are set    $requiredFields = ['zt_titre', 'zt_intro', 'ta_news', 'ld_section'];        foreach ($requiredFields as $field) {        if (!isset($_POST[$field])) {            retour_erreur(11, 23);        }    }        $zt_titre = nl2br(stripslashes($_POST['zt_titre']));    $zt_intro = nl2br(stripslashes($_POST['zt_intro']));    $section = $_POST['ld_section'];    $news_date = date("Y-m-d");        // Get the user-generated HTML content    $userHtml = $_POST['ta_news'];        // Create an HTML Purifier configuration    $config = HTMLPurifier_Config::createDefault();    $purifier = new HTMLPurifier($config);// Clean and sanitize the HTML content    $cleanHtml = $purifier->purify($userHtml);// Validate the length of the HTML content (adjust as needed)    $maxLength = 10000;    if (strlen($cleanHtml) > $maxLength) {        retour_erreur(11, 123); // Handle the error    }                // Define the valid file extensions    $extensions_valides = array('jpg', 'jpeg', 'png');    $page = '11';    $error_code = '1024';        // Handle file upload    $dossier = "img/_news/";    $destination = handleFileUpload($_FILES['f_photo_actu'], $dossier, $extensions_valides, $page, $error_code);        $stmt = $db->prepare('INSERT INTO ACTUALITE (titre, date_actu, intro, texte, photo, id_section) VALUES (?, ?, ?, ?, ?, ?)');    $execute = $stmt->execute([        $zt_titre,        $news_date,        $zt_intro,        $cleanHtml,        $destination,        $section    ]);    if ($execute) {        $stmt->closeCursor();        retour_erreur(11,101);    } else {        retour_erreur(11,102);    }?>